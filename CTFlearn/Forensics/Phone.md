<h1><b>Phone</h1></b>
<pre>
My boss was calling me yesterday but I wasn't able to answer the phone. He left me an encoded message in the voicemail. There are a lot of weird sounds going on. I have to know what he wanted to tell me. Could you help me decode it? I bet it's something important.

Here is the audio file from my voicemail:

<a href='https://ctflearn.com/challenge/download/1008'>phone.wav</a>
</pre>
</b><h3>Solution</h3></b>
<p>Diberikan sebuah file audio.wav yang jika dibuka itu merupakan suara sinyal DTMF. Decode semua sinyal dengan tool dtmf-decoder, dan berikut hasilnya</p>
<pre>
9892730000000100110110081000000#011A1110100011001010111110#0100010101800B0101110100010#0100010100110011110100010#0100010111101011010100010#0111110101110001010111110#0000000101010101010000000#1111111110100111011111111#0011000111110111011010000#118000011000010710010100110#10101001071101100111000111#00000011110150100001101001#10000100C01000111000111000#001001001101010100100000#1110100011000010111100011#11111110210011D111101001010#000011001001101000B0001010#1111111100000110011100110#0000000111100000010101011#011111010410011010111C01011#01000310101111111000001001#01000101101000071000011100#01000101911001001001011001#0111110100011110010101001#000000010111111010D0000000#476528
</pre>
<p>Split semua digit dengan batasan #, dan hapus semua digit yang nilainya bukan 1 dan 0, dan jika digitnya tidak sama banyak maka tambah 0 pada digit paling akhir. dan berikut hasilnya</p>
<pre>
0000000100110110010000000#
0111110100011001010111110#
0100010101000101110100010#
0100010100110011110100010#
0100010111101011010100010#
0111110101110001010111110#
0000000101010101010000000#
1111111110100111011111111#
0011000111110111011010000#
1100001100001010010100110#
1010100101101100111000111#
0000001111010100001101001#
1000010001000111000111000#
0010010011010101001000000#
1110100011000010111100011#
1111111010011111101001010#
0000110010011010000001010#
1111111100000110011100110#
0000000111100000010101011#
0111110101001101011101011#
0100010101111111000001001#
0100010110100001000011100#
0100010111001001001011001#
0111110100011110010101001#
0000000101111110100000000#
</pre>
<p>Jika diperhatikan lebih details pola digit dapat membentuk sebuah QR-Code, lalu bentuk QR code dengan script dibawah ini</p>

```python
from pyzbar import pyzbar
import numpy as np
import cv2


arr = "0000000100110110010000000011111010001100101011111001000101010001011101000100100010100110011110100010010001011110101101010001001111101011100010101111100000000101010101010000000111111111010011101111111100110001111101110110100001100001100001010010100110101010010110110011100011100000011110101000011010011000010001000111000111000000100100110101010010000011101000110000101111000111111111010011111101001010000011001001101000000101011111111000001100111001100000000111100000010101011011111010100110101110101101000101011111110000010010100010110100001000011100010001011100100100101100101111101000111100101010010000000101111110100000000"
list = []
for i in arr:
    if int(i)==1:
        list.append(255)
    else:
        list.append(int(i))
img = np.array(list)
img = img.reshape(25,25).astype('float32') 
resized = cv2.resize(img, (36*10,37*10), interpolation = cv2.INTER_AREA)
cv2.imwrite('Result.png',resized)

img = cv2.imread("Result.png")
barcodes = pyzbar.decode(img)
print(barcodes)

for barcode in barcodes:
    (x, y, w, h) = barcode.rect
    cv2.rectangle(img, (x, y), (x + w, y + h), (0, 0, 255), 2)
    barcodeData = barcode.data.decode("utf-8")
    barcodeType = barcode.type
    text = "{} ({})".format(barcodeData, barcodeType)
    cv2.putText(img, text, (x, y - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 0, 255), 2)
    print("[INFO] found {} barcode {}".format(barcodeType, barcodeData))

```
<p>Dan Output program</p>
<p align='center'>
  <img src='https://github.com/enomarozi/Writeup-CTF_Online/blob/master/CTFlearn/Forensics/Images/Phone.png'>
</p>
<pre>
found QRCODE barcode CTFlearn{DTMF_1s_y0ur_fr13nd}
</pre>
</b><h3>Flag</h3></b>
<pre>
CTFlearn{DTMF_1s_y0ur_fr13nd}
</pre>
