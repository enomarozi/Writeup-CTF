  <h1><b>DTune</h1></b>
  <pre>
  Vector recorded this audio when Gill Bates was opening his/her vault and Gru stole this recording from him (stealing from a thief ain't a crime, right?). 
  Help Gru decode this message so that he can ...(Use your imagination)
  http://static.beast.sdslabs.co/static/DTUNE/Dtune.wav
  </pre>
  <h3><b>Solution</b></h3>
  <p>Diberikan sebuah file wav audio, dan audio yang keluar berupa DTMF. Decode audio DTMF pada <a href="http://dialabc.com/sound/detect/">dialabc</a>, dan hasilnya</p>
<table
class=dtdTones><tr><td
align=center
class=dtdTopTh>Tone</td><td
align=right
class=dtdTopTh>Start
Offset
[ms]</td><td
align=right
class=dtdTopTh>End
Offset
[ms]</td><td
align=right
class=dtdTopTh>Length
[ms]</td></tr><tr><td
align=center><div
class=dtdTone>8</div></td><td
align=right><div
class=dtdText>0
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>4</div></td><td
align=right><div
class=dtdText>301
&plusmn;
15</div></td><td
align=right><div
class=dtdText>603
&plusmn;
15</div></td><td
align=right><div
class=dtdText>301
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>3</div></td><td
align=right><div
class=dtdText>694
&plusmn;
15</div></td><td
align=right><div
class=dtdText>995
&plusmn;
15</div></td><td
align=right><div
class=dtdText>301
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>0</div></td><td
align=right><div
class=dtdText>1,086
&plusmn;
15</div></td><td
align=right><div
class=dtdText>1,297
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>3</div></td><td
align=right><div
class=dtdText>1,388
&plusmn;
15</div></td><td
align=right><div
class=dtdText>1,810
&plusmn;
15</div></td><td
align=right><div
class=dtdText>422
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>5</div></td><td
align=right><div
class=dtdText>1,901
&plusmn;
15</div></td><td
align=right><div
class=dtdText>2,323
&plusmn;
15</div></td><td
align=right><div
class=dtdText>422
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>2</div></td><td
align=right><div
class=dtdText>2,384
&plusmn;
15</div></td><td
align=right><div
class=dtdText>2,595
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>4</div></td><td
align=right><div
class=dtdText>2,686
&plusmn;
15</div></td><td
align=right><div
class=dtdText>2,897
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>0</div></td><td
align=right><div
class=dtdText>2,987
&plusmn;
15</div></td><td
align=right><div
class=dtdText>3,199
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>4</div></td><td
align=right><div
class=dtdText>3,289
&plusmn;
15</div></td><td
align=right><div
class=dtdText>3,712
&plusmn;
15</div></td><td
align=right><div
class=dtdText>422
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>7</div></td><td
align=right><div
class=dtdText>3,802
&plusmn;
15</div></td><td
align=right><div
class=dtdText>4,165
&plusmn;
15</div></td><td
align=right><div
class=dtdText>362
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>7</div></td><td
align=right><div
class=dtdText>4,195
&plusmn;
15</div></td><td
align=right><div
class=dtdText>4,315
&plusmn;
15</div></td><td
align=right><div
class=dtdText>120
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>0</div></td><td
align=right><div
class=dtdText>4,376
&plusmn;
15</div></td><td
align=right><div
class=dtdText>4,617
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>7</div></td><td
align=right><div
class=dtdText>4,678
&plusmn;
15</div></td><td
align=right><div
class=dtdText>5,221
&plusmn;
15</div></td><td
align=right><div
class=dtdText>543
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>4</div></td><td
align=right><div
class=dtdText>5,281
&plusmn;
15</div></td><td
align=right><div
class=dtdText>5,432
&plusmn;
15</div></td><td
align=right><div
class=dtdText>150
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>4</div></td><td
align=right><div
class=dtdText>5,462
&plusmn;
15</div></td><td
align=right><div
class=dtdText>5,613
&plusmn;
15</div></td><td
align=right><div
class=dtdText>150
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>2</div></td><td
align=right><div
class=dtdText>5,704
&plusmn;
15</div></td><td
align=right><div
class=dtdText>5,915
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>2</div></td><td
align=right><div
class=dtdText>5,975
&plusmn;
15</div></td><td
align=right><div
class=dtdText>6,217
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>5</div></td><td
align=right><div
class=dtdText>6,277
&plusmn;
15</div></td><td
align=right><div
class=dtdText>6,519
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>6</div></td><td
align=right><div
class=dtdText>6,579
&plusmn;
15</div></td><td
align=right><div
class=dtdText>6,820
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>0</div></td><td
align=right><div
class=dtdText>6,881
&plusmn;
15</div></td><td
align=right><div
class=dtdText>7,122
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>6</div></td><td
align=right><div
class=dtdText>7,183
&plusmn;
15</div></td><td
align=right><div
class=dtdText>7,605
&plusmn;
15</div></td><td
align=right><div
class=dtdText>422
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>3</div></td><td
align=right><div
class=dtdText>7,696
&plusmn;
15</div></td><td
align=right><div
class=dtdText>8,118
&plusmn;
15</div></td><td
align=right><div
class=dtdText>422
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>0</div></td><td
align=right><div
class=dtdText>8,179
&plusmn;
15</div></td><td
align=right><div
class=dtdText>8,420
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>3</div></td><td
align=right><div
class=dtdText>8,480
&plusmn;
15</div></td><td
align=right><div
class=dtdText>8,812
&plusmn;
15</div></td><td
align=right><div
class=dtdText>331
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>7</div></td><td
align=right><div
class=dtdText>8,903
&plusmn;
15</div></td><td
align=right><div
class=dtdText>9,114
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>2</div></td><td
align=right><div
class=dtdText>9,205
&plusmn;
15</div></td><td
align=right><div
class=dtdText>9,597
&plusmn;
15</div></td><td
align=right><div
class=dtdText>392
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>3</div></td><td
align=right><div
class=dtdText>9,688
&plusmn;
15</div></td><td
align=right><div
class=dtdText>9,899
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>4</div></td><td
align=right><div
class=dtdText>9,990
&plusmn;
15</div></td><td
align=right><div
class=dtdText>10,322
&plusmn;
15</div></td><td
align=right><div
class=dtdText>331
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>9</div></td><td
align=right><div
class=dtdText>10,382
&plusmn;
15</div></td><td
align=right><div
class=dtdText>10,714
&plusmn;
15</div></td><td
align=right><div
class=dtdText>331
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>4</div></td><td
align=right><div
class=dtdText>10,804
&plusmn;
15</div></td><td
align=right><div
class=dtdText>11,106
&plusmn;
15</div></td><td
align=right><div
class=dtdText>301
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>6</div></td><td
align=right><div
class=dtdText>11,197
&plusmn;
15</div></td><td
align=right><div
class=dtdText>11,408
&plusmn;
15</div></td><td
align=right><div
class=dtdText>211
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>2</div></td><td
align=right><div
class=dtdText>11,499
&plusmn;
15</div></td><td
align=right><div
class=dtdText>11,921
&plusmn;
15</div></td><td
align=right><div
class=dtdText>422
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>2</div></td><td
align=right><div
class=dtdText>11,982
&plusmn;
15</div></td><td
align=right><div
class=dtdText>12,223
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>7</div></td><td
align=right><div
class=dtdText>12,283
&plusmn;
15</div></td><td
align=right><div
class=dtdText>12,615
&plusmn;
15</div></td><td
align=right><div
class=dtdText>331
&plusmn;
30</div></td></tr><tr><td
align=center><div
class=dtdTone>9</div></td><td
align=right><div
class=dtdText>12,676
&plusmn;
15</div></td><td
align=right><div
class=dtdText>12,917
&plusmn;
15</div></td><td
align=right><div
class=dtdText>241
&plusmn;
30</div></td></tr></table>
<p>Perhatikan semua Tone dengan Length-nya</p>
<pre>8 4 3 0 3 5 2 4 0 4 7 7 0 7 4 4 2 2 5 6 0 6 3 0 3 7 2 3 4 9 4 6 2 2 7 9</pre>
<p>Hasil sesuai Length</p>
<pre>8 44 33 0 333 555 2 4 0 444 7777 0 7777 44 2 2 5 6 0 666 333 0 33 7 222 3 44 99 44 6 222 2 77 9</pre>
<p>Decode DTMF ke ASCII sesuai pada gambar</p>
<p align='center'>
  <img src="https://github.com/enomarozi/BackdoorCTF_Writeup/blob/master/Images/dtmf.gif">
</p>

```python
enc = "8 44 33 0 333 555 2 4 0 444 7777 0 7777 44 2 2 5 6 0 666 333 0 33 7 222 3 44 99 44 6 222 2 77 9".split(" ")
table_dtmf = {2:"ABC",3:"DEF",4:"GHI",5:"JKL",6:"MNO",7:"PQRS",8:"TUV",9:"WXYZ"}
for i in enc:
    if int(i) == 0:
        print(" ",end="")
    elif int(i) != 0:
        a = len(i)
        print(table_dtmf[int(i[:1])][a-1],end="")
    
```
<h3><b>Flag</b></h3>
<pre>THE FLAG IS SHA256 OF EPCDHXHMCAQW</pre>

